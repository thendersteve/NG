(function($){var clone=function(obj){var obj2={};$.each(obj,function(key,val){obj2[key]=val;});return obj2;};var set=function(obj,key,val){var obj2=clone(obj);obj2[key]=val;return obj2;};$.fn.down=function(selector){if(typeof selector==='undefined')return this.children(':eq(0)');else return this.find(selector+':first');};$.fn.up=$.fn.closest;$.fn.Each=function(callback){this.each(function(){callback(this);});};$.Each=function(arr,callback){return $.each(arr,function(index,value){callback(value,index);});};$.method=function(obj,name){return function(){obj[name].apply(obj,arguments);};};$.invoke=function(obj,method,args){var f;if(args&&args.length){f=function(x){return x[method].apply(x,args);};}else{f=function(x){return x[method]();};}
return $.map(obj,f);};$.endsWith=function(haystack,needle){return haystack.substr(haystack.length- needle.length)===needle;};$.beginsWith=function(haystack,needle){return haystack.substr(0,needle.length)===needle;};$.fn.serialize=function(as_array){if(as_array)return this.serializeArray();else return $.param(this.serializeArray());};$.fn.isLoaded=function(value){var is_loaded=true;this.find('img').each(function(){if(this.fail)return;if(this.tagName==='IMG'){if(typeof(this.naturalWidth)!=='undefined'){is_loaded=is_loaded&&this.complete;}else if(typeof(this.complete)==='boolean'){is_loaded=is_loaded&&this.naturalWidth;}else{is_loaded=is_loaded&&this.width;}}else{}});return is_loaded;};$.fn.loaded=function(handler,data){var total_time=0;if(!data)data={};if(data.period===undefined)data.period=100;if(data.timeout===undefined)data.timeout=5000;var that=this;var doWaiting=function(){if($(that).isLoaded()||total_time>data.timeout){handler(that);if(that._loaded_timer){clearTimeout(that._loaded_timer);}}else{total_time+=data.period;that._loaded_timer=setTimeout(doWaiting,data.period);}};doWaiting();};$.fn.enable=function(){var that=$(this);if(that.is('form')){that.find('input, textarea, select, button').enable();}else{that.each(function(){that.prop('disabled',false);});}
return this;};$.fn.disable=function(){var that=$(this);if(that.is('form')){that.find('input, textarea, select, button').disable();}else{that.prop('disabled',true);}
return this;};$.fn.setUploadVal=function(val){if(typeof val==='undefined'){val=this.val();}
if(this.is('input[type="file"]')){this.next().next().val(this.val());}
return this;};$.fn.validate=function(validations){if(this.is('form')){this.bindValidator(new NgFormValidator(this,validations));}
return this;};$.fn.focusToEnd=function(){return this.each(function(){var v=$(this).val();$(this).focus().val("").val(v);});};(function(){var getSubmitButtons=function(elem){return $(elem).find('button[type!="reset"][type!="button"], input[type="submit"]');};$.fn.disableSubmit=function(){getSubmitButtons(this).disable();};$.fn.enableSubmit=function(){getSubmitButtons(this).enable();};})();$.fn.preventDoubleSubmit=function(){this.submit(this.disableSubmit);};$.fn.allowDoubleSubmit=function(){this.off('submit',this.disableSubmit);};(function(){var
validation_str='validation',getValidationFunction=function(validator){if(validator){return function(e){validator.validate();if(!validator.isValid()){validator.inform();e.stopImmediatePropagation();return false;}};}};$.fn.bindValidator=function(validator){var validation=getValidationFunction(validator);this.data(validation_str,validation);this.data('validator',validator);return this.submit(validation);};$.fn.unbindValidator=function(){return this.off('submit',this.data(validation_str));};})();$.fn.exists=function(){return this.length>0;};$.fn.Text=function(){return $.map(function(){return $(this).text();}).get();};var addFunction=function(func_list,func){if(typeof func_list==='function'){return[func_list,func];}else if(typeof func_list==='object'){return func_list.concat([func]);}else{return func;}};$.fn.ajaxSubmit=function(success_func,options){var that=this;options=options||{};var originator,action,method='post';if(this.is('form')||(this.is('button')&&this.attr('type')==='submit')){if(this.is('form')){originator='form';action=this.attr('action');}else{if(!this.attr('formaction')||!this.attr('formmethod')){throw"Must get form action and method";}
originator='button';action=this.attr('formaction');method=this.attr('formmethod');}
options=set(options,originator,this);return $.ajaxWait(method,action,null,success_func,options);}};$.fn.ajaxify=function(success_func,options){if(this.is('form')){var that=this;options=options||{};options.form=options&&options.form||this;this.on('click','button',function(){options.data=that.serializeArray();options.data.push({name:this.name,value:this.value});$(that).ajaxSubmit(success_func,options);return false;});return this.submit(function(){$(this).ajaxSubmit(success_func,options);return false;});}};$.fn.ajaxifyLink=function(options,confirmation){if((typeof options==='string'||typeof options==='function')&&typeof confirmation===typeof undefined){confirmation=options;options=true;}else if(typeof options==='function'){confirmation=options;options=true;}
options=options||{};confirmation=confirmation?confirmation:false;if(true===options){options={};options.success_func=true;}
if(typeof options.data===typeof undefined){options.data={};}
if(typeof options.data.userkey===typeof undefined){options.data.userkey=PHP.get('uek');}
if(false===confirmation&&options.confirmation){confirmation=options.confirmation;}
$(this).off().on('click',function(){if(undefined!==options.onclick){options.onclick(this);}
if(confirmation){if(typeof confirmation==='string'){if(!confirm(confirmation)){return false;}}else if(typeof confirmation==='function'){var ret;if(false===(ret=confirmation(this))){return false;}
if(ret){if(true===ret){options.success_func=true;}else if(undefined!==ret.success_func){options.success_func=ret.success_func;}}
if(ret&&undefined!==ret.error){options.error=ret.error;}}}
$.ajaxWait('post',this.href,null,null,options);return false;});};$.fn.ajaxClick=function(url,success_func,options){var that=$(this);var attrs_from_el=function(which){var parts=that.attr(which).split('_');var val=parts.pop();return[parts.join('_'),val];};var attr_name=that.attr('name')||attrs_from_el('rel')[0]||attrs_from_el('id')[0];var val=that.attr('value')||attrs_from_el('rel')[1]||attrs_from_el('id')[1];var data=[{name:attr_name,value:val}];$.ajaxWait('post',url,data,success_func,options);return false;};$.fn.ajaxKeyup=function(url,success_func,options){var data=[{name:$(this).attr('name'),value:$(this).attr('value')}];$.ajaxWait('get',url,data,success_func,options);return false;};$.fn.formifyLink=function(params){if(!this.is('a')){console.error("formifyLink can only be used on <a> tags.");return false;}
if(typeof(params)=='function')params=params($(this));else if(typeof(params)!='object')params={};if(!params.userkey){params.userkey=PHP.get('uek');}
var action=$(this).attr('href');var $form=$('<form>').attr('action',action).attr('method','post');$('body').prepend($form);for(var i in params){var val=typeof(params[i])=='function'?params[i]($(this)):params[i];var $input=$('<input>');$input.attr('type','hidden').attr('name',i).val(val);$form.append($input);};this.attr('href','#');this.click(function(){$form.submit();return false;});}
$.fn.getSelected=function(){if(this.is('select')){var select=this.get(0);if(select){if(!select.selectedIndex)select.selectedIndex=0;return $(select.options[select.selectedIndex]);}else{return $();}}};$.fn.scrollTo=function(options){var destination=this.offset().top;options=options||{};options.duration=options.duration||500;$('html:not(:animated), body:not(:animated)').animate({scrollTop:destination- 20},options);};(function(){var slide_duration=600,fade_duration=600;var fadeMeIn=function(){$(this).animate({opacity:1},fade_duration);};var scrollMeUp=function(){$(this).slideUp(slide_duration);};$.fn.appear=function(){return this.css('opacity',0).slideDown(slide_duration,fadeMeIn);};$.fn.disappear=function(){return this.animate({opacity:0},{duration:fade_duration,complete:scrollMeUp});};$.fn.animatedSwitch=function(){if(this.is(':visible'))return this.disappear();else return this.appear();};})();(function(){var
fading_menus=[],count_showing=0,fade_all=function(excluded){var i;for(i=0;i<fading_menus.length;++i){if(i!==excluded&&fading_menus[i].is(':visible'))fading_menus[i].fadeOut();--count_showing;}};$.fn.fadeable=function(){if(!fading_menus.length){$(document.body).click(function(){if(count_showing){fade_all();}});}
this.each(function(){var select,menu;var me=$(this);select=me.is('div.select')?me:me.up('div.select');menu=select.down('ul.filtermenu');if(menu.length&&$.inArray(menu,fading_menus)<0){fading_menus.push(menu);menu.data('fading_index',fading_menus.length- 1).hide().css('overflow','visible');select.click(function(e){if(e.target.tagName.toLowerCase()!=='a'){if(menu.is(':hidden')){++count_showing;menu.fadeIn(300,function(){$(this).show();});fade_all(menu.data('fading_index'));}else{menu.fadeOut();--count_showing;}
return false;}});}});};})();$.isString=function(obj){return typeof obj==='string'||obj instanceof String;};$.reverseString=function(str){return str.split('').reverse().join('');};$.unparam=function(str){var obj={};str.split('&').Each(function(equality){var parts=equality.split('=');obj[parts[0]]=parts[1];});return obj;};$.isInteger=function(obj){return typeof obj==='number'&&parseInt(obj,10)===obj;};$.range=function(low,high,step){var
reversal,quickstep=1,arr=[],i;if((!$.isInteger(low)&&!$.isString(low))||(typeof low!==typeof high)){return arr;}
if(typeof step!==undefined&&$.isInteger(step)&&$.isInteger(low)){quickstep=step;}
if($.isString(low)){low=parseInt(low.charCodeAt(0),10);high=parseInt(high.charCodeAt(0),10);}
if(low>high){reversal=low;low=high;high=reversal;}
for(i=low;i<=high;i+=quickstep){arr.push(i);}
return arr;};$.strip_text=function(s){return s.toLowerCase().replace(/[^a-z0-9]/g,' ').replace(/\s+/g,'-').replace(/(^-+|-+$)/,'');};$.rInArray=function(value,arr){return $.inArray(value,arr)!==-1;};$.any=function(arr,f){var len=arr.length;for(var i=0;i<len;i++){if(f(arr[i]))return true;}
return false;};$.all=function(arr,f){return!$.any(arr,function(x){return!f(x);});};$.nub=function(arr){var new_arr=[],len=arr.length,i,j,found_dup;for(i=0;i<len;++i){found_dup=false;for(j=i+ 1;j<len&&!found_dup;++j){found_dup=arr[j]==arr[i];}
if(!found_dup)new_arr.unshift(arr[i]);}
return new_arr;};$.$=function(elem_or_id){if($.isString(elem_or_id))return $('#'+ elem_or_id);else return $(elem_or_id);};$.windowHeight=function(){return window.innerHeight?window.innerHeight:$(window).height();};$(document).ajaxError(function(e,xhr,options,exception){if(xhr.status==403){$.showAjaxError(JSON.parse(xhr.responseText));}});$.showAjaxError=function(content){if(content&&content.errors&&content.errors.join){var msg=content.errors.join("\n");if(content.selector){$(content.selector).html(msg);}else{alert(msg);}}else{var server_error='Server error.  Please wait a moment and try again.';alert(server_error);}};$.checkAjaxErrorOld=function(xml){var server_error='Server error.  Please wait a moment and try again.';if(!xml){alert(server_error);return false;}else{var errors=$(xml).find('errormsg');if(errors.length){alert(errors.text());return false;}else{return true;}}};$(document).ajaxComplete(function(e,xhr,options){if(xhr.uid){$.ajax.stopWaiting(xhr.uid);}
if(window.QUnit){window.QUnit.ajaxing=false;}
enableSelectFacades();$('a').each(function(){$(this).data('clicked',false);});});(function(){var
waiters={},waitheres={};$.ajax.startWaiting=function(xhr,form,element){xhr.uid=$.now();if(form){form=$(form);waiters[xhr.uid]=form.find('.waiter').removeClass('waiter').addClass('waiter_on');}
if(element){element=$(element);waiters[xhr.uid]=element;element.addClass('waithere');}};$.ajax.stopWaiting=function(xhr_uid){if(waiters[xhr_uid]){waiters[xhr_uid].removeClass('waiter_on').addClass('waiter');delete waiters[xhr_uid];}
if(waitheres[xhr_uid]){waitheres[xhr_uid].removeClass('waithere');delete waitheres[xhr_uid];}};})();$.ajaxWait=function(type,url,data,success_func,options){options=options||{};if(options.form||options.button){if(false!==options.preventDouble){options.error=addFunction(options.error,function(){if(options.form){options.form.enableSubmit();}else{options.button.enable();}});if(options.form){options.form.disableSubmit();}else{options.button.disable();}}
if(!data){if(options.data){data=options.data;}else if(options.form){data=options.form.serializeArray();}}}else if(!data&&options.data){data=options.data;}
if(options.additional_data&&options.form){if(!$.isArray(options.additional_data)){data.push(options.additional_data);}else{$.merge(data,options.additional_data);}}
if(PHP&&PHP.get('ng_design',null))$.merge(data,[{name:'___ng_design',value:PHP.get('ng_design')}]);if(!success_func&&options.success_func){success_func=options.success_func;}
if(true===success_func){success_func=function(response){if(response&&response.success){alert(response.success);}
if(response&&response.url){window.location.href=response.url;return true;}
window.location.href=window.location.href;};}
var ajax_options=$.extend({type:type,url:url,data:data,success:success_func},options);return $.ajax.startWaiting($.ajax(ajax_options),options.form,options.element);};$.ajax.replace=function(response_html,selectors){var i=0;for(i=0;i<selectors.length;i++){$(selectors[i]).replaceWith($(selectors[i],response_html));}};$.Event.prototype.closest=function(selector){var me=this.target;while(me&&!$(me).is(selector)){if(me==this.currentTarget)return;me=me.parentNode;}
return me;};$.fn.insertRoundCaret=function(tagName){var
strStart,strEnd,stringBefore,stringAfter,sel,insertstring,fullinsertstring,range,numlines,i,j,startPos,endPos,scrollTop;return this.each(function(){strStart='['+tagName+']';strEnd='[/'+tagName+']';if(document.selection){stringBefore=this.value;this.focus();sel=document.selection.createRange();insertstring=sel.text;fullinsertstring=strStart+ sel.text+ strEnd;sel.text=fullinsertstring;document.selection.empty();this.focus();stringAfter=this.value;i=stringAfter.lastIndexOf(fullinsertstring);range=this.createTextRange();numlines=stringBefore.substring(0,i).split("\n").length;i=i+3-numlines+tagName.length;j=insertstring.length;range.move("character",i);range.moveEnd("character",j);range.select();}else if(this.selectionStart||this.selectionStart=='0'){startPos=this.selectionStart;endPos=this.selectionEnd;scrollTop=this.scrollTop;this.value=this.value.substring(0,startPos)+ strStart+ this.value.substring(startPos,endPos)+ strEnd+ this.value.substring(endPos,this.value.length);this.focus();this.selectionStart=startPos+ strStart.length;this.selectionEnd=endPos+ strStart.length;this.scrollTop=scrollTop;}else{this.value+=strStart+ strEnd;this.focus();}});};(function(){var
upper_ranges=$.range('A','Z'),lower_ranges=$.range('a','z'),all_letters=upper_ranges.concat(lower_ranges),wrap_element,type,shift_key,which;$.fn.checkCapsLock=function(e){wrap_element=$('#'+ $(this).attr('id')+'_caps');return(function(event){type=event.type;shift_key=event.shiftKey;which=event.which;if(type==='blur'){wrap_element.hide();}else if(($.rInArray(which,upper_ranges)&&!shift_key)||($.rInArray(which,lower_ranges)&&shift_key)){wrap_element.show();}else if($.rInArray(which,all_letters)&&wrap_element.is(':visible')){wrap_element.hide();}})(e);};})();(function(){$.fn.selectBoxOptions=function(){var
that=this,i=0,key,options=document.getElementById(this.attr('id')).options;return{size:function(){return $(options).size();},set:function(new_options){i=0;for(var key in new_options){++i;}
options.length=i;i=0;for(key in new_options){options[i].value=key;options[i].text=new_options[key];++i;}}};};})();(function(){$.fn.watchLinks=function(settings){settings=$.extend({parentNode:'.podcontent',trustedDomains:[],spamDomains:[]},settings);var link_watcher=new LinkWatcher();link_watcher.setParentNode(settings.parentNode);link_watcher.setTrustedDomains(settings.trustedDomains);link_watcher.setSpamDomains(settings.spamDomains);link_watcher.pushElements($(this));link_watcher.watch();return this;};$.fn.watchEmbeds=function(){var redesign=false;var mobile=false;var MAX_WIDTH=590;var MAX_HEIGHT=332;if(redesign&&mobile){MAX_WIDTH=461;MAX_HEIGHT=269;}
if(PHP&&PHP.get&&PHP.get('ng_design','2012')!='2012'){redesign=true;mobile=PHP.get('ismobile',false);}
var
watchable_links=[],result,mylink,mydiv,href,sites={youtube:[/^https?:\/\/(www\.)?((youtube\.com\/(.*?v=|embed\/))|youtu\.be\/)([a-zA-Z0-9_\-]+).*$/,5,'video'],vimeo:[/^https?:\/\/(www\.)?vimeo\.com\/([0-9]+)\/?$/,2,'video'],soundcloud:[/^https?:\/\/(www\.)?(soundcloud\.com\/[^\/]+\/?([^\/]+\/?)?).*$/,2,'audio']},addClickContext=function(context){context.off('click').on('click',function(){$(this).next().toggle();return false;});},getYouTubeDivContent=function(url,full_url){var result,time=null,iframe_attr;if(null!==(result=full_url.match(/(\?|#)t=((\d+)m(\d+)s)/))){time=(parseInt(result[3],10)*60)+ parseInt(result[4],10);}else if(null!==(result=full_url.match(/t=(\d+)/))){time=result[1];}
if(null!==time){url=url+'?start='+ time.toString();}
if(redesign){iframe_attr='data-smart-scale="590,332" data-smartload-src="'+ url+'" frameborder="0" allowfullscreen';}else{iframe_attr='width="'+ MAX_WIDTH+'" height="'+ MAX_HEIGHT+'" src="'+ url+'" frameborder="0" allowfullscreen';}
return $('<div style="display:none; margin-top: 10px; width: 100%; height: auto;"><iframe '+iframe_attr+'></iframe></div>');},getVimeoDivContent=function(content){var d=$('<div style="display:none; margin-top: 10px; width: 100%; height: auto;"></div>');d[0].innerHTML=content;return d},getSoundCloudDivContent=function(content){var d=$('<div style="display:none; margin-top: 10px; width: 100%; height: auto;"></div>');d[0].innerHTML=content;return d},throwIEDebugDiv=function(xhr,statusText,errorText){return $('<div style="display:none;">'+ errorText+'</div>');},insertDiv=function(key,identifier,mycontext,regexp_result,index){mycontext.css('cursor','wait');var resetCursor=function(){mycontext.css('cursor','pointer');};var onFail=function(){console.log(arguments);mycontext.off('click');resetCursor();window.open(mycontext.attr('href'));};var renderContent=function(contentFunc,maybe_json,other){if(typeof other!==typeof undefined){mydiv=contentFunc(maybe_json,other);}else{mydiv=contentFunc(maybe_json.html);}
mycontext.after(mydiv);mydiv.slideDown(function(){addClickContext(mycontext);resetCursor();});};mydiv=null;switch(key){case'youtube':renderContent(getYouTubeDivContent,'https://www.youtube.com/embed/'+ identifier,mycontext.attr('href'));break;case'vimeo':var url="https://vimeo.com/"+ identifier
$.get('https://vimeo.com/api/oembed.json',{'url':url,'maxwidth':MAX_WIDTH,'maxheight':MAX_HEIGHT},function(response){renderContent(getVimeoDivContent,response);},'json').fail(onFail);break;case'soundcloud':$.get('https://soundcloud.com/oembed',{'url':'https://'+ identifier,'format':'json','maxwidth':MAX_WIDTH,'maxheight':MAX_HEIGHT,'iframe':true},function(response){console.log(response);renderContent(getVimeoDivContent,response);},'json').fail(onFail);break;default:console.log('Bad site');return;}
return mydiv;};var to_load={}
$(this).each(function(index){mylink=$(this);href=mylink.attr('href');if(typeof href===typeof undefined||href===false){return this;}
for(var key in sites){if(sites.hasOwnProperty(key)){result=href.match(sites[key][0]);if(result){to_load[index]=[key.toString(),result[sites[key][1]],mylink,result,index];}}}});var items=$($(this).selector);items.click(function(){var index=items.index(this);if(to_load.hasOwnProperty(index)){insertDiv.apply(this,to_load[index]);delete to_load[index];return false;}
$(this).off('click');});return this;};})();(function(){var dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){val=String(val);len=len||2;while(val.length<len)val="0"+ val;return val;};return function(date,mask,utc){var dF=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(date)=="[object String]"&&!/\d/.test(date)){mask=date;date=undefined;}
date=date?new Date(date):new Date;if(isNaN(date))throw SyntaxError("invalid date");mask=String(dF.masks[mask]||mask||dF.masks["default"]);if(mask.slice(0,4)=="UTC:"){mask=mask.slice(4);utc=true;}
var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+"Minutes"](),s=date[_+"Seconds"](),L=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:dF.i18n.dayNames[D],dddd:dF.i18n.dayNames[D+ 7],m:m+ 1,mm:pad(m+ 1),mmm:dF.i18n.monthNames[m],mmmm:dF.i18n.monthNames[m+ 12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),l:pad(L,3),L:pad(L>99?Math.round(L/10):L),t:H<12?"a":"p",tt:H<12?"am":"pm",T:H<12?"A":"P",TT:H<12?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,""),o:(o>0?"-":"+")+ pad(Math.floor(Math.abs(o)/ 60) * 100 + Math.abs(o) % 60, 4),
S:["th","st","nd","rd"][d%10>3?0:(d%100- d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length- 1);});};}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};Date.prototype.format=function(mask,utc){return dateFormat(this,mask,utc);};})();(function(){var fromDateTime=function(datetime){var a=$.map(datetime.split(/[^0-9]/),function(s){return parseInt(s,10)});return new Date(a[0],a[1]-1||0,a[2]||1,a[3]||0,a[4]||0,a[5]||0,a[6]||0);};var couNtinGDate=function(start_datetime,end_datetime,options){var DOWN='down',UP='up';options=options||{};var that=this,start=fromDateTime(start_datetime),end=fromDateTime(end_datetime);var params=$.extend({format:'fullDate',html_element:null,interval:10,direction:DOWN,timeup_message:null,timeup_callback:null,writing_output:true,writing_output_method:null,verbose:false,ucfirst:false},options);var formatOutput=function(diff,hours,minutes,seconds){var really,output,is_short;is_short=params.format==='shortDate';if(hours){really=Math.round(diff/3600);if(really===1){if(is_short){output='1 hr';}else{output='an hour';}}else{if(is_short){output=really+' hr';}else{output=really+' hours';}}
if(!is_short){output='about '+ output;}}else if(minutes){really=minutes;if(!is_short){if(really===1){output='a minute';}else{output=really+' minutes';}}else{output=really+' min';}}else{if(!is_short){output='a few seconds';}else{output='&lt; 1 min';}}
if(!is_short){if(params.direction===DOWN){output=output+' ago';}else{output=output+' left';}}
if(params.ucfirst){output=output.charAt(0).toUpperCase()+ output.substr(1);}
return output;};var doCounting=function(diff,hours,minutes,seconds){var output=[];hours=parseInt(hours,10);minutes=parseInt(minutes,10);seconds=parseInt(seconds,10);var found_prev=false;var pluralize=function(unit,label){var str=label;if(1!==unit){label=label+'s';}
return unit+' '+ label;};if(hours>24){return'';}
if(hours>0||params.verbose){found_prev=true;output.push(pluralize(hours,'hour'));}
if(minutes>0||params.verbose||found_prev){found_prev=true;output.push(pluralize(minutes,'minute'));}
if(seconds>0||params.verbose||found_prev){output.push(pluralize(seconds,'second'));}
var last=output.pop();if(output.length){return output.join(', ')+' and '+ last;}else{return last;}};var handleOutputWriting=function(diff){var hours=Math.floor(diff/3600);var minutes=Math.floor((diff-(hours*3600))/ 60);
var seconds=diff-(hours*3600)-(minutes*60);if(null!==params.writing_output_method){if(true===params.writing_output_method){params.html_element.html(doCounting(diff,hours,minutes,seconds));}else if(typeof String===typeof params.writing_output_method){throw'Did you forget something?';}else{params.html_element.html(params.writing_output_method(diff,hours,minutes,seconds));}}else{params.html_element.html(formatOutput(diff,hours,minutes,seconds));}};var run=function(){var diff=Math.abs(end- start)/ 1000;
if((params.direction===UP&&start>end)||(diff<=0&&params.direction===UP)||(params.direction===DOWN&&start>end)||(diff>=86400&&params.direction===DOWN)){if(null!==params.timeup_callback){params.timeup_callback();}else if(null!==params.timeup_message&&params.writing_output){params.html_element.html(params.timeup_message);}else if(params.writing_output){params.html_element.html(start.format(params.format));}}else{if(params.writing_output){handleOutputWriting(diff);}
window.setTimeout(function(){if(params.direction===DOWN){end.setSeconds(end.getSeconds()+ params.interval);}else{start.setSeconds(start.getSeconds()+ params.interval);}
run();},1000*params.interval);}};return{setOurInterval:function(seconds){params.interval=seconds;},begin:function(element){params.html_element=$(element);if(params.html_element){run();}
return that;},setFormat:function(new_format){params.format=new_format;},setDateAtTimeFormat:function(){params.format='mm/dd/yy @ hh:MM TT';},setDirection:function(new_direction){if(!$.rInArray(new_direction,[UP,DOWN])){throw'Invalid direction.';}
params.direction=new_direction;},setTimeupMessage:function(message){params.timeup_message=message;},setTimeupCallback:function(callback){params.timeup_callback=callback;},setWritingOutput:function(bool){params.writing_output=bool;},setWritingOutputMethod:function(method){params.writing_output_method=method;}}};$.couNtinGDate=couNtinGDate;$.fn.couNtinGDate=function(start_datetime,end_datetime,options){if(typeof start_datetime===typeof undefined||typeof start_datetime==='object'){if(typeof start_datetime==='object'){options=start_datetime;}
start_datetime=$(this).html().trim();}
if(typeof end_datetime===typeof undefined){end_datetime=PHP.get('datetime',false);}
options=options||{};var instance=new $.couNtinGDate(start_datetime,end_datetime,options);return instance.begin($(this));};$.couNtinGManyDatesFromNow=function(selector,options){var end_datetime=PHP.get('datetime',false);if(!end_datetime){return false;}
var elements=$(selector);if(elements){elements.each(function(){var html=$(this).html().trim();if(html.match(/^\d+-\d+-\d+ \d+:\d+:\d+$/)){$(this).couNtinGDate(html,end_datetime,options);}});}
return elements;};})();(function(){$.fn.scrollWithPage=function(options){options=options||{};options=$.extend({duration:200,easing:'swing'},options);var element=$(this),element_height=element.outerHeight(),element_offset_top=element.offset().top,win_height,doc_height,scroll_to,previous_scroll=0,original_css_position=element.css('position'),opened_once=null,topper;var doc_height=$(document).height();$(window).resize(function(){opened_once=null;});$(document).on('scroll',function(){element_height=element.outerHeight();if($(this).scrollTop()>($(window).height()- element_height)){scroll_to=$(this).scrollTop()- element_offset_top;if($(window).height()<element_height&&previous_scroll<$(this).scrollTop()){scroll_to-=(element_height- $(window).height());}}else{scroll_to=0;}
previous_scroll=$(this).scrollTop();if(undefined===options.animate||false!==options.animate){if(($(document).scrollTop()+ element_height)>doc_height){scroll_to-=element_height;}
element.animate({marginTop:scroll_to},options.duration,options.easing);}else{if(null===opened_once&&$(window).height()>element_height){opened_once=true;}
if(($(this).scrollTop()>element_offset_top)&&(true===opened_once||$(window).height()>element_height)){if($(window).height()<element_height){topper=$(window).height()- element_height;}else{topper=0;}
element.css({position:'fixed',top:topper});}else{element.css({position:original_css_position});}}
if(null===opened_once){opened_once=false;}});};})();$(document).ready(function(){$('a').on('click',function(){var that=$(this),clickdata=that.data('clicked');var ignore=that.hasClass('mod')||that.hasClass('dim');if(clickdata&&parseInt($.now()- clickdata,10)<1000&&!ignore){return false;}else if(!ignore){that.data('clicked',null);}
if(!that.attr('target')){that.data('clicked',$.now());}});});})(jQuery);jQuery.fx.interval=1/45*1000;jQuery.noConflict();function begins_with(str,needle){return str.substring(0,needle.length)===needle;}
function ends_with(str,needle){return str.substring(str.length- needle.length)===needle;}
function NewWindow(url,height,width,myname){if(typeof myname===typeof undefined){myname="newwin"+ GetRandomNumber(1000000,9999999);}
var winprops='height='+ height+',width='+ width+',top='+((screen.height- height)/ 2) + ',left=' + ((screen.width - width) / 2) + ',status=yes,scrollbars=yes,resizable=yes,toolbar=no,location=no,menubar=no';
var win=window.open(url,myname,winprops);win.window.focus();return win;}
function Reload(){window.location.href=window.location.href;}
function IsValidInteger(num){return num.length&&!(/[^0-9]+/.exec(num));}
function CountOccurences(val,expr){var parts=val.split(expr);return parts.length-1;}
function Trim(text){return String(text).replace(/(^\s*|\s*$)/g,"");}
function Round(num,precision){if(typeof precision===typeof undefined){precision=0;}
var multiplier=Math.pow(10,precision);return Math.round(num*multiplier)/ multiplier;
}
function SelectValue(select){if(typeof select==="string"){return SelectValue(document.getElementById(select));}else if(typeof select=="object"){return select.options[select.selectedIndex].value;}else{alert("Don't know how to do a SelectValue on "+ select);return null;}}
function FormatNumber(num){num=num.toString();var len=num.length;if(len<=3){return num;}else if(len<=6){return num.substring(0,len- 3)+","+ num.substring(len- 3,len);}else if(len<=9){return num.substring(0,len- 6)+","+ num.substring(len- 6,len- 3)+","+ num.substring(len- 3,len);}else if(len<=12){return num.substring(0,len- 9)+","+ num.substring(len- 9,len- 6)+","+ num.substring(len- 6,len- 3)+","+ num.substring(len- 3,len);}else{return-1;}}
function GetRandomNumber(low,high){return Math.floor((Math.random()*(high- low+ 1))+ low);}
function GetPercentage(part,total){if(!part){return 0;}
return FormatNumber(part/total*100);}
function HandleClick(element_name){var this_element=document.getElementById(element_name);if(this_element.disabled){return;}
if(this_element.type==="checkbox"){this_element.checked=!(this_element.checked);}else if(this_element.type==="radio"){this_element.checked=true;}}
function CharactersRemaining(textarea,maxnum,remaining_char_count_elem){if(PHP.get('DEBUG')&&!textarea){if(window.console&&console.log){console.log("missing textarea for CharsRemaining() in ng.js");}
return;}
if(textarea){var chars_remaining=maxnum- textarea.value.length;if(chars_remaining<0)
{textarea.value=textarea.value.substring(0,maxnum);chars_remaining=0;}
if(!remaining_char_count_elem){remaining_char_count_elem=document.getElementById(textarea.id+"_chars_remaining");}
remaining_char_count_elem.innerHTML=FormatNumber(chars_remaining);}}
function CharactersRemainingMinusHTML(textarea,maxnum,maxnumminushtml){CharactersRemaining(textarea,maxnumminushtml);var chars_remaining=maxnum- textarea.value.replace(/<\/?(a|i(ns)?|b|u|em|strong).*?>/ig,'').length;if(chars_remaining<0)
{chars_remaining=0;}
document.getElementById(textarea.id+"_chars_remaining_minus_html").innerHTML=FormatNumber(chars_remaining);}
(function(){var chars_remaining_timeouts=[];CheckCharsRemaining=function(id,max_chars,max_chars_minus_html)
{if(max_chars_minus_html>0)
{CharactersRemainingMinusHTML(document.getElementById(id),max_chars,max_chars_minus_html);}
else
{CharactersRemaining(document.getElementById(id),max_chars);}
chars_remaining_timeouts[id]=setTimeout("CheckCharsRemaining('"+ id+"', "+ max_chars+", "+ max_chars_minus_html+")",1500);};CheckCharsRemainingInElem=function(id_or_elem,max_chars,max_chars_minus_html,remaining_char_count_elem)
{var
elem=$(id_or_elem),check_chars;if(max_chars_minus_html>0){check_chars=function(){CharactersRemainingMinusHTML(elem,max_chars,max_chars_minus_html);};}else{check_chars=function(){CharactersRemaining(elem,max_chars,remaining_char_count_elem,remaining_char_count_elem);};}
check_chars();chars_remaining_timeouts[elem.identify()]=setInterval(check_chars,1500);};StopCharsRemaining=function(id)
{clearTimeout(chars_remaining_timeouts[id]);};})();function GetAge(month,day,year,nowmonth,nowday,nowyear)
{var age=nowyear-year;if(month<nowmonth){age--;}else if(month==nowmonth&&day>nowday)
{age--;}
return age;}
function CheckDate(month,day,year)
{var test_date=new Date(month+"/"+ day+"/"+ year);if(test_date.getMonth()+ 1==month)
{return true;}
return false;}
function InArray(needle,haystack){for(var i=0,len=haystack.length;i<len;i++){if(needle==haystack[i]){return true;}}
return false;}
function remove_value(needle,haystack){var index=jQuery.inArray(needle,haystack);if(index>=0){haystack.splice(index,1);}
return haystack;}
function DOMNodeFromHTML(html){var holder_node=Builder.node("div");holder_node.innerHTML=html;for(var i=0;i<holder_node.childNodes.length;i++)
{if(holder_node.childNodes[i].nodeType==1)
{return(holder_node.childNodes[i]);}}
return(null);}
function ScrollToElement(elementid)
{new Effect.ScrollTo(elementid);}
var reviewmod_win;function OpenReviewModWindow(url)
{reviewmod_win=window.open("http://redirect.ngfiles.com"+ url);}
function CloseReviewModWindow()
{reviewmod_win.close();}
function DotAnimatedText(element_name,animate_class)
{var
NUM_ANIMATION_DOTS=5,ANIMATION_CYCLE_TIME=0.5,timeout_handle=null,dot_count=1,animation_text="",original_animation_html="",add_class=(typeof animate_class=="string"),element=null;this.Start=function(text_to_animate)
{original_animation_html=GetElement().innerHTML;animation_text=text_to_animate;StepAnimation();};this.Stop=function()
{EndAnimation();SetElementHTML(original_animation_html);};function StepAnimation()
{var newtext="";if(add_class)
{newtext+="<span class=\""+ animate_class+"\">";}
newtext+=animation_text;for(var i=1;i<=dot_count;i++)
{newtext+=".";}
dot_count++;if(dot_count>NUM_ANIMATION_DOTS)
{dot_count=1;}
if(add_class)
{newtext+="</span>";}
SetElementHTML(newtext);timeout_handle=setTimeout(StepAnimation,(ANIMATION_CYCLE_TIME/NUM_ANIMATION_DOTS)*1000);}
function GetElement()
{return $(element_name);}
this.getElement=function()
{return GetElement();};function SetElementHTML(html)
{var element=GetElement();if(element)
{element.innerHTML=html;}
else
{EndAnimation();}}
function EndAnimation()
{if(timeout_handle)
{clearTimeout(timeout_handle);timeout_handle=null;}}}
function HeaderAnimator(element_id,animation_text)
{var
ANIMATION_CLASSNAME="i-activity",animation_running=false,button_link_html=[],button_classes=[],animated_text=new DotAnimatedText(element_id+"_header"),GetHeader,original_text=GetHeader().firstChild.data,original_classname=GetHeader().className,activity_image=new Image();activity_image.src="http://img.ngfiles.com/hicons/i67.gif";this.Start=function(text_to_animate)
{if(!(animation_running))
{animation_running=true;if(typeof text_to_animate=="string")
{animation_text=text_to_animate;}
animated_text.Start(animation_text);GetHeader().className=ANIMATION_CLASSNAME;MakeButtonsDead();}};this.Stop=function()
{if(animation_running)
{animation_running=false;animated_text.Stop();GetHeader().className=original_classname;MakeButtonsLive();}};function MakeButtonsLive()
{var button_elements=GetButtons();var button;for(var i=0;i<button_elements.length;i++)
{button=button_elements[i];button.innerHTML=button_link_html[i];button.className=button_classes[i];}}
function MakeButtonsDead()
{var button_elements=GetButtons();var button;for(var i=0;i<button_elements.length;i++)
{button=button_elements[i];button_link_html[i]=button.innerHTML;button_classes[i]=button.className;button.innerHTML="<span>"+ button.firstChild.innerHTML+"</span>";button.className="btn dead";}}
GetHeader=function(){return document.getElementById(element_id+"_header");};function GetButtons()
{var
all_spans=GetHeader().parentNode.getElementsByTagName("span"),buttons=[],i;for(i=0;i<all_spans.length;i++)
{if(/_button$/.test(all_spans[i].id))
{buttons[buttons.length]=all_spans[i];}}
return buttons;}}
function AddRemoveSpace(element)
{if(typeof element.value=="string")
{element.value+=" ";element.value=element.value.substring(0,element.value.length- 1);}
else
{element.firstChild.data+=" XYZ";element.firstChild.data=element.firstChild.data.substring(0,element.firstChild.data.length- 4);}}
function FlashWriter(url,width,height)
{var
LookForFlashPlugin=function(){var flash_versions=12,x;if(navigator.plugins&&navigator.plugins.length){for(x=0;x<navigator.plugins.length;x++){if(navigator.plugins[x].name.indexOf('Shockwave Flash')!=-1){return(true);}}}else if(window.ActiveXObject){for(x=2;x<=flash_versions;x++){try{var oFlash=new ActiveXObject(ShockwaveFlash.ShockwaveFlash[x]);if(oFlash){return true;}}
catch(e){}}}
return(false);},DEFAULT_WINDOW_SETTING="window",quality="high",id="flash"+ GetRandomNumber(1000000,9999999),wmode=DEFAULT_WINDOW_SETTING,script_access="sameDomain",allow_fullscreen="false",fullscreen_on_selection="false",params=null,has_flash=LookForFlashPlugin();this.SetQuality=function(new_quality){quality=new_quality;};this.SetID=function(new_id){id=new_id;};this.SetTransparent=function(is_transparent){wmode=is_transparent?"transparent":DEFAULT_WINDOW_SETTING;};this.SetOpaque=function(is_opaque){wmode=is_opaque?"opaque":DEFAULT_WINDOW_SETTING;};this.SetDirect=function(is_direct){wmode=is_direct?'direct':DEFAULT_WINDOW_SETTING;};this.SetFullScreen=function(fullscreen){allow_fullscreen=fullscreen?"true":"false";};this.SetFullScreenOnSelection=function(fullscreen){fullscreen_on_selection=fullscreen?"true":"false";};this.SetScriptAccess=function(new_script_access){script_access=new_script_access;};this.SetParams=function(new_params){params=new_params;};this.ToString=function(){var str="";if(has_flash){str=[str,'<object classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,0,0" width="'+ width+'" height="'+ height+'" id="'+ id+'">','<param name="allowScriptAccess" value="'+ script_access+'" />','<param name="allowFullScreen" value="'+ allow_fullscreen+'" />','<param name="movie" value="'+ url+'" /><param name="quality" value="'+ quality+'" />','<param name="wmode" value="'+ wmode+'" />','<param name="fullScreenOnSelection" value="'+ fullscreen_on_selection+'" />'].join('');if(params){str+='<param name="flashvars" value="'+ params+'" />';}
str+='<embed src="'+ url+'" quality="'+ quality+'" ';if(params){str+='flashvars="'+ params+'" ';}
str=[str,'wmode="'+ wmode+'" width="'+ width+'" height="'+ height+'" name="'+ id+'" allowScriptAccess="'+ script_access+'" ','fullScreenOnSelection="'+ fullscreen_on_selection+'" ','allowFullScreen="'+ allow_fullscreen+'" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" />','</object>'].join('');}else{str+='<p style="text-align: center; margin-top: 2em; margin-bottom: 2em; padding-top: 3em; padding-bottom: 3em; background: #333333">You don\'t appear to have <a target="_blank" href="http://getflash.ngfiles.com">Flash</a> installed. <a target="_blank" href="http://getflash.ngfiles.com">Click here</a> to get it (it\'s free).</p>';}
return str;};this.Print=function(){document.write(this.ToString());};}
function CheckboxItems(total,prefix){var ids=[],keys=[];function GetElement(id){return document.getElementById(prefix+ id);}
this.ToggleAll=function(){ids=[];keys=[];var is_checked,is_disabled,element;for(var i=0;i<total;i++){element=GetElement(i);is_checked=element.checked;is_disabled=element.disabled;if(!is_checked&&!is_disabled){keys[keys.length]=i;ids[ids.length]=element.value;}
if(!is_disabled){element.checked=!is_checked;}}};this.Toggle=function(id)
{var element=GetElement(id),i;if(element.checked&&!InArray(element.value,ids)){keys[keys.length]=id;ids[ids.length]=element.value;}else if(!element.checked&&InArray(element.value,ids)){for(i=0;i<total;i++){if(element.value==ids[i]){keys.splice(i,1);ids.splice(i,1);break;}}}};this.ClearAll=function(){ids=[];keys=[];for(var i=0;i<total;i++){GetElement(i).checked=false;}};this.SelectAll=function(){ids=[];keys=[];for(var i=0;i<total;i++){GetElement(i).checked=true;keys[keys.length]=i;ids[ids.length]=GetElement(i).value;}};this.Enable=function(){for(var i=0;i<total;i++){GetElement(i).disabled=false;}};this.Disable=function(){for(var i=0;i<total;i++){GetElement(i).disabled=true;}};this.GetKey=function(num){return keys[num];};this.GetKeys=function(){return keys;};this.GetID=function(num){return ids[num];};this.GetIDS=function(){return ids;};this.IsToggled=function(){return ids.length>0;};this.GetNumChecked=function(){return ids.length;};}
var PHP=(function(){var vars={};return{get:function(var_name,default_value){return PHP.has(var_name)?vars[var_name]:default_value;},set:function(var_name,value){return(vars[var_name]=value);},has:function(var_name){return typeof vars[var_name]!=='undefined';},req:function(var_name){if(!PHP.has(var_name)){alert(var_name+" must be set, but it isn't.");}
return PHP.get(var_name);},add:function(var_name,value){if(!PHP.has(var_name)){PHP.set(var_name,[]);}
return vars[var_name].push(value);},merge:function(obj){for(var key in obj){if(obj.hasOwnProperty(key)){PHP.set(key,obj[key]);}}}};})();var NiGhtBox=(function($){var
blackout_class='blackout-on',no_dimming_class='nodimming',no_dim_class='nodim',visibility='visibility',KEY_ESC=27,elem,height,loading,no_dim_elem,ads,blackout,blackout_center,visible=false,hide_on_esc=true,stored_content=null,getAds=function(){if(!ads)ads=$('.adunit');return ads;},hideAds=function(){getAds().css(visibility,'hidden');},showAds=function(){getAds().css(visibility,'visible');},escHandler,updateEscListener=function(){if(hide_on_esc&&visible){$('body').keydown(escHandler);}else{$('body').off('keydown',escHandler);}};escHandler=function(e){if(e.which==KEY_ESC){if(!NiGhtBox.onClosed||NiGhtBox.onClosed()!==false){NiGhtBox.hide();updateEscListener();}
return false;}};return{autohide:true,onClosed:null,init:function(){blackout=$('#blackout');blackout_center=$('#blackout_center');blackout_hover=$('#blackout_hover');$blackout_bg=$('#blackout-bg');$blackout_bg.click(function(){if(NiGhtBox.autohide&&PHP.get('ng_design',2012)!=2012&&(!NiGhtBox.onClosed||NiGhtBox.onClosed()!==false)){NiGhtBox.hide();}
return false;});var c=blackout_center.html().trim();if(c.length){stored_content=c;}
return NiGhtBox;},load:function(elem,elem_height,afterLoad){if(!blackout||!blackout_center){NiGhtBox.init();}
loading=true;elem.detach();blackout_center.append(elem).loaded(function(){if(typeof elem_height==='function'){height=elem_height(blackout_center,blackout);}else if(typeof elem_height===typeof undefined){elem_height=elem.height();}else{height=elem_height;}
loading=false;if(afterLoad){afterLoad();}});return NiGhtBox;},replace:function(elem,elem_height,afterLoad){if(!blackout||!blackout_center){NiGhtBox.init();}
blackout_center.down().remove();if(typeof elem_height!==typeof undefined){height=elem_height;delete elem_height;}
NiGhtBox.load(elem,elem_height,afterLoad);return NiGhtBox;},restore:function(){if(!blackout||!blackout_center){NiGhtBox.init();}
if(stored_content){blackout_center.html(stored_content);height=blackout_center.down().height();}
return NiGhtBox;},show:function(element){if(!blackout||!blackout_center){NiGhtBox.init();}
var nodim=element?true:false;element=element?$.$(element):blackout_center.down();var win_height,scroll;if(element){setTimeout(function(){if(!height){height=element.height();}
if(height){scroll=Math.max($('html').scrollTop(),$(window).scrollTop());win_height=$(window).height();var $notification_bar=$('#notification-bar');if($notification_bar.outerHeight())win_height-=$notification_bar.outerHeight();if(height>win_height){blackout_center.css('margin-top',scroll+'px');}else{blackout_center.css('margin-top',scroll+(win_height- height)/ 2 + 'px');
}}else{$(element).addClass();}},1);}
hideAds();blackout.addClass(blackout_class);blackout.show();blackout_hover.show();if(element&&nodim)element.addClass(no_dim_class);if(element){element.show();}
visible=true;if(hide_on_esc){updateEscListener();}
$(document).trigger('NiGhtBox:on');return NiGhtBox;},hide:function(element){var nodim=element?true:false;if(!blackout||!blackout_center){NiGhtBox.init();}
element=element?$.$(element):blackout_center.down();showAds();blackout.removeClass(blackout_class);blackout.hide();blackout_hover.hide();if(element&&nodim)element.removeClass(no_dim_class);visible=false;if(hide_on_esc){updateEscListener();}
$(document).trigger('NiGhtBox:off');return NiGhtBox;},toggle:function(element){if(!blackout||!blackout_center){NiGhtBox.init();}
if(blackout.hasClass(blackout_class)){return NiGhtBox.hide(element);}else{return NiGhtBox.show(element);}},visible:function(){return visible;},hideOnEsc:function(bool){hide_on_esc=bool;updateEscListener();return NiGhtBox;}};})(jQuery);var NgFormValidator=function(the_form,validations){var
inputs,errors=[],$=jQuery,form,callback;form=$(the_form);if(!form.length){throw'Form not found in NgFormValidator()';}
var
failed=function(validation){errors.push({name:validation.name||validation[0],msg:validation.msg||validation[validation.length- 1]});},hasError=function(name){return $.any(errors,function(err){return name==err.name;});},checkValidation=function(type,validation,inputs){var
name=validation.name||validation[0],input=inputs.filter("[name='"+ name+"']"),val,passed,i,len;if(input.length===0){return true;}else if(input.length===1){if(input.attr('type')==='checkbox'){val=input.filter(':checked').val();}else{val=input.val();}}else{val=input.filter(':checked').first().val();}
if(PHP.get('DEBUG')&&!input.exists()&&type!=='checked'){throw'Required input does not exist: '+ name;}
switch(type){case'require':passed=val&&val.length;break;case'regex':passed=!val||val.match(validation.regex||validation[1]);break;case'min_length':passed=val&&val.length>=(validation.length_requirement||validation[1]);break;case'max_length':passed=!val||val.length<=(validation.length_requirement||validation[1]);break;case'checked':passed=!input.exists()||input.is(':checked');break;case'equals':passed=!val||val===inputs.filter("[name='"+(validation.second_value||validation[1])+"']").val();break;case'one_of':others=validation;passed=val&&val.length;for(i=1,len=others.length- 1;i<len;++i){val=inputs.filter("[name='"+(others[i])+"']").val();passed=passed||val&&val.length;}
break;case'greater_than':passed=val&&parseInt(val,10)>parseInt((validation.min||validation[1]),10);break;default:throw'Unknown validation type: '+ type;}
if(!passed){failed(validation);}},dependenciesValid=function(validator){if(validator.depends&&!$.isArray(validator.depends)){throw"'depends' property of validator must be an array";}
return!validator.depends||!$.any(validator.depends,function(name){return hasError(name);});},doCallback=function(){if(callback){callback();}};this.validate=function(){errors=[];inputs=form.find('input:enabled, textarea:enabled, select:enabled');if(inputs&&inputs.length){$.each(validations,function(type,validation_list){var len=validation_list.length;for(var i=0;i<len;++i){if(dependenciesValid(validation_list[i])){checkValidation(type,validation_list[i],inputs);}}});}else if(PHP.get('DEBUG')){if(window.console&&console.log){console.log('no inputs found');}}
var is_valid=errors.length===0;if(!is_valid){doCallback();}
return is_valid;};this.getErrors=function(){return errors;};this.isValid=function(){return errors.length===0;};this.getErrorMessages=function(){var msgs=[];for(var i=errors.length- 1;i>=0;--i){msgs.push(errors[i].msg);}
return $.nub(msgs);};this.getFailedInputs=function(){var failures=[];for(var i=errors.length- 1;i>=0;--i){failures.push(errors[i].name);}
return failures;};this.sendFocusTo=function(input_name){if(typeof input_name==='undefined'){inputs.filter("[name='"+(errors.pop().name)+"']").focus();}else{if(PHP.get('DEBUG')&&!inputs.filter("[name='"+ input_name+"']").exists()){throw'Cannot focus on this, as it does not exist: '+ input_name;}
inputs.filter("[name='"+ input_name+"']").focus();}};this.setCallback=function(call_backable)
{callback=call_backable;}};NgFormValidator.prototype.inform=function(){alert(this.getErrorMessages().join("\n"));};NgXmlDom=function(response){this._xml=response;};NgXmlDom.prototype={isValidDom:function(){if(this._is_valid_dom===undefined){this._is_valid_dom=this._xml&&this._xml.documentElement;}
return this._is_valid_dom;},getXml:function(){return this._xml;},getField:function(tag_name){if(this.isValidDom()){var node_list=this._xml.documentElement.getElementsByTagName(tag_name);if(node_list&&node_list.length==1&&node_list[0].firstChild){return node_list[0].firstChild.data;}}},hasField:function(tag_name){if(this.isValidDom()){var node_list=this._xml.documentElement.getElementsByTagName(tag_name);return node_list&&node_list.length==1&&node_list[0].firstChild;}},STATUS_ERROR:0,STATUS_SUCCESS:1,STATUS_ERROR_SILENT:2,validate:function(error_handler){var response_status=this.getField('status');if(!response_status&&0!==response_status){alert('Server error.  Please wait a moment and try again.');if(error_handler){error_handler(this);}
return false;}else{switch(parseInt(response_status,10)){case this.STATUS_SUCCESS:return true;case this.STATUS_ERROR:alert('Error - '+ this.getField('errormsg'));if(error_handler){error_handler(this);}
return false;case this.STATUS_ERROR_SILENT:return false;}}}};function enableSelectFacades(){var $=jQuery;var has_select_facades=$('div.select select').off;if(has_select_facades===undefined)return;var
showSelected=function(select){var $select=$(select);$select.prev().text($select.getSelected().text());},select_event_handler=function(){showSelected(this);};$('div.select select').off('change',select_event_handler).on('change',select_event_handler).off('keyup',select_event_handler).on('keyup',select_event_handler).off('keydown',select_event_handler).on('keydown',select_event_handler).Each(showSelected);}
jQuery(function($){var
init_fp_web_features=function(){var feature_link=function(cpm){return'<li><a href="'+ cpm.getLink()+'"><img title="" alt="Ad Icon" src="'+ cpm.getImageUrl(70,70)+'" width="70" height="39" /></a><div><div><div><a href="'+ cpm.getLink()+'">'+ cpm.getTitle()+'</a><span>'+ cpm.getDescription(100)+'</span></div></div></div></li>';};if(window.cpmStar){var
webfeature=$('div#webfeature'),cpm_list=$('<ul class="centeredblocks webfeature"></ul>'),num_ads=8,i;for(i=num_ads- 1;i;--i){cpm_list.append(feature_link(cpmStar));cpmStar.nextAd();}
cpm_list.append(feature_link(cpmStar));webfeature.append(cpm_list);}};$('div.podtop a.min').click(function(e){if($(this).hasClass('ignore'))return false;var
$this=$(this),pt=$this.parentsUntil('div.podtop').parent().parent(),podtop;podtop=$this.parents('div.podtop:first');if(!podtop.hasClass('minimized'))podtop.addClass('minimized');return false;});$('div.podtop a.max').click(function(e){if($(this).hasClass('ignore'))return false;var podtop=$(this).parents('div.podtop:first');if(podtop.hasClass('minimized'))podtop.removeClass('minimized');return false;});$('input[type="reset"]').click(function(e){return confirm('Are you sure you want to reset this form?');});$('input[type="file"]').change(function(e){$(this).setUploadVal();});$('table.alternate tr:odd').addClass('alt');if(PHP.get('is_ie')){$('label').click(function(e){$('#'+ e.closest('label').attr('for')).click();e.preventDefault();});}
(function(){var
currently_shown,animating=[],hovering=false,uniq=0,unanimate=function(uniq_id){animating=remove_value(uniq_id,animating);},not_animating=function(uniq_id){return!InArray(uniq_id,animating);};$('#header_nav > dl').each(function(){this.my_dds=$(this).children('dd');this.uniq=++uniq;}).mouseenter(function(e){var me=this.uniq,mine=this.my_dds;hovering=me;if(not_animating(me)){animating.push(me);currently_shown={dds:mine,uniq:me};this.my_dds.slideDown(50,function(){unanimate(me);if(me!==hovering){mine.hide();}});}
return false;}).mouseleave(function(e){var me=this.uniq,mine=this.my_dds;hovering=false;if(not_animating(me)){animating.push(me);this.my_dds.slideUp('fast',function(){unanimate(me);if(me===hovering){mine.show();}});}
return false;});})();$('#topsearch').submit(function(e){e.preventDefault();var search=$('#topsearch_text').val().replace('/',' ');var url=PHP.get('search_urls')[$('#topsearch_type').getSelected().val()]+'/'+
encodeURIComponent(search);document.location=url;});var is_iphone_ipad_or_ipod=navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/);PHP.set('is_iphone_ipad_or_ipod',is_iphone_ipad_or_ipod);var label_username=$('#header_label_username');if(label_username.length){var
label_password=$('#header_label_password'),input_username=$('#username'),input_password=$('#password'),remember_me=$('#remember'),assignLabelAction=function(input,label){label.click(function(){$(this).hide();input.focus();});},defaultLabel=function(input,label){var defaultIfEmpty=function(){if(input.val()){label.hide();}else{label.show();}};input.focus(function(){label.hide();}).blur(defaultIfEmpty).blur();setTimeout(defaultIfEmpty,100);};defaultLabel(input_username,label_username);defaultLabel(input_password,label_password);if(is_iphone_ipad_or_ipod){assignLabelAction(input_username,label_username);assignLabelAction(input_password,label_password);remember_me.css('z-index','9999');}
remember_me.next('span').click(function(){remember_me.checked=!remember_me.checked;});}
var adcode_html={};var lights=true;var handleLights=function(obj){var standalone=typeof undefined===typeof obj;obj=typeof undefined===typeof obj?null:obj;NiGhtBox.toggle();if(lights){lights=false;$('div[id^="adcode_iframe_"]').each(function(){var id=$(this).attr('id');var html=$(this).html();adcode_html[id]=html;$(this).html("");});}else{lights=true;$('div[id^="adcode_iframe_"]').each(function(){var id=$(this).attr('id');var html=adcode_html[id];$(this).html(html);});adcode_html={};}};$('.podtop').on('click',function(e){var link=$(e.closest('a'));if(link.length){if(link.hasClass('dim')){handleLights($(this).parent());}else if(link.hasClass('max')){$(this).removeClass('minimized');}else if(link.hasClass('min')){link.addClass('minimized');}else{return;}
e.preventDefault();}});(function(){var
pl_add_form=$('#playlist_add'),pl_add_form_exists=pl_add_form.exists();$('.pl-add').click(function(){if(pl_add_form_exists){pl_add_form.toggle();return false;}});})();enableSelectFacades();init_fp_web_features();$(document).ready(function(){});});function addEvent(elem,evnt,func){if(elem.addEventListener){elem.addEventListener(evnt,func,false);return true;}else if(elem.attachEvent){elem.attachEvent("on"+evnt,func);return true;}else{console.log('Your browser does not support event listeners');return false;}}
if(typeof(([]).indexOf)=="undefined"){Array.prototype.indexOf=function(o,i){for(var j=this.length,i=i<0?i+ j<0?0:i+ j:i||0;i<j&&this[i]!==o;i++);return j<=i?- 1:i;};}
var SearchHelper2=(function($){var helper=this;var field,form,prefix,template_id,suggestion_endpoint;var DEFAULT_TEMPLATE='search_suggestion_template';var $active_view=null;var active_index=[];var populateSuggestion=function(values,$element){for(var i in values){$('[data-html="'+i+'"]',$element).html(values[i]);$('[data-src="'+i+'"]',$element).attr('src',values[i]);$('[data-href="'+i+'"]',$element).attr('href',values[i]);}};var lookup=function(_request,_render){var search_params=form.serializeArray();$.post(suggestion_endpoint,search_params,function(response){var i;var x=0;var items=[];for(i in response.terms){x++;items.push({template:'terms',text:response.terms[i],id:template_id+"-"+x});}
for(i in response.suggestions){if(i===0){response.suggestions[i].break=true;}
x++;response.suggestions[i].id=template_id+"-"+ x;response.suggestions[i].template='content-'+ response.suggestions[i].content_type;items.push(response.suggestions[i]);}
for(i in response.more_links){if(i===0){response.more_links[i].break=true;}
x++;response.more_links[i].id=template_id+"-"+ x;response.more_links[i].template='links';items.push(response.more_links[i]);}
_render(items);});};var render=function($ul,item){var template=helper.getTemplate();if(typeof(item.template)==='undefined'||typeof(template[item.template])==='undefined'){console.log('missing template for item',item);return;}
var $li=template[item.template].clone();if(typeof(item.break)!=='undefined'&&item.break){$li.addClass('ui-autocomplete-break');}
console.log('rendering');$li.attr('id',item.id);populateSuggestion(item,$li);return $li.appendTo($ul);};var $focus=null;var onFocus=function(e,ui){var label=ui.item.text||ui.item.title;if($focus){$focus.removeClass('selected');}
$focus=$('#'+ ui.item.id);$focus.addClass('selected');return false;};var onSelect=function(e,ui){if(ui.item.url){window.location=ui.item.url;return false;}
var label=ui.item.text||ui.item.title;console.log(ui.item);console.log(e);if(label){field.val(label);}
form.submit();return false;};var watch_field=function(){field.autocomplete({delay:50,source:lookup,focus:onFocus,select:onSelect}).data('ui-autocomplete')._renderItem=render;};this.getTemplate=function(){if(typeof template_id===typeof undefined){template_id=DEFAULT_TEMPLATE;}
if(typeof(helper.template[template_id])===typeof undefined){helper.template[template_id]={};$template=$($.trim($("#"+template_id).html()));$('li[class^="ui-autocomplete-"]',$template).each(function(){var key=$(this).attr('class').replace('ui-autocomplete-','');helper.template[template_id][key]=$(this);});}
return helper.template[template_id];};var watchSearchBar=function(){var $searchbar=form;var $nav=$('#search-header-nav');if(!$searchbar.exists()||!$nav.exists()){return;}
var current=PHP.get(prefix+'_current_nav');if(current){console.log("")
$('a:contains('+ current+')',$nav).addClass('current');}
var getSearchParams=function(url){var name,value=null;url=url||window.location.href;parts=url.split('?');if(parts.length===1){return[];}
parts=parts[1].split('&');params={};for(i=0,len=parts.length;i<len;++i){bits=parts[i].split('=');name=bits[0];if(typeof undefined!==typeof bits[1]){value=decodeURIComponent(bits[1].replace(/\+/g,' '));}else{value=null;}
params[name]=value;}
return params;};$nav.find('a').on('click',function(){alert($searchbar.find('input[name="terms"]').val());return false;var url=window.location.href;var params=getSearchParams(url);var new_params=['terms='+ $searchbar.find('input[name="terms"]').val()];for(var n in params){if(n!=='terms'){new_params.push(n+'='+ params[n]);}}
var new_url=this.href.split('?')[0]+'?'+ new_params.join('&');window.location.href=new_url;return false;});};var watchDates=function(){if(typeof undefined===typeof prefix){return;}
var after=$('#'+ prefix+'_after');var before=$('#'+ prefix+'_before');if(!after.exists()&&!before.exists()){return;}
if(PHP.get('ismobile')){if(after){ngutils.forms.registerDateInput(after.attr('id'));}
if(before){ngutils.forms.registerDateInput(before.attr('id'));}}else{var checkDates=function(settings){if(after&&before){var low=after.val();var high=before.val();var minDate=new Date(settings.minDate);var maxDate=new Date(settings.maxDate);console.log(maxDate);if(!low||!high){return;}
a=new Date(low);b=new Date(high);if(a>=b){var temp=new Date(a.getTime());temp.setDate(temp.getDate()+ 1);if(temp===maxDate){before.val('');after.val($.datepicker.formatDate('yy-mm-dd',a));}else{after.val($.datepicker.formatDate('yy-mm-dd',a));before.val($.datepicker.formatDate('yy-mm-dd',temp));}}else if(b<a){var temp=new Date(b.getTime());temp.setDate(temp.getDate()- 1);if(temp===minDate){after.val('');before.val($.datepicker.formatDate('yy-mm-dd',temp));}else{after.val($.datepicker.formatDate('yy-mm-dd',temp));before.val($.datepicker.formatDate('yy-mm-dd',b))}}}};var params={'dateFormat':'yy-mm-dd','minDate':'2016-01-10','maxDate':PHP.get(prefix+'_max_date'),onSelect:function(str,obj){checkDates(obj.settings);}};after.datepicker(params);before.datepicker(params);}};var watchSuitabilities=function(){var inputs=$('#suitabilities_opts input');var hidden_field=form.find('input[name="suitabilities"]');if(!inputs.length){return false;}
inputs.click(function(){var checked=this.checked;var that=this;console.log(inputs.serializeArray());$.post('/suitabilities',inputs.serializeArray()).fail(function(){that.checked=!checked;});});};this.setTemplate=function(_template){template_id=_template;return this;}
this.init=function(_field,_suggestion_endpoint,_template_id,_autocomplete){var parts;helper.template=helper.template||{};autocomplete=(typeof _autocomplete==='undefined'?true:_autocomplete);if($.type(_field)==='string'){parts=_field.split('_');field=$('#'+ _field);}else{field=_field;parts=field.attr('id');}
prefix=parts[0];if(!field.parents('form')){throw"Can't find form for field.";}
if(autocomplete){if((typeof(_suggestion_endpoint)!==typeof undefined)&&(null!==_suggestion_endpoint)){suggestion_endpoint=_suggestion_endpoint;}else{suggestion_endpoint=form.attr('action');}
if(typeof(_template_id)!==typeof undefined&&null!==_template_id){template_id=_template_id;}
this.getTemplate();form=field.parents('form');watch_field();}
watchSearchBar();watchDates();watchSuitabilities();};return this;})(jQuery);var SearchHelper=(function($){var conductSearch=function($form){var new_params=[];var params=$form.serializeArray();for(var i=0,len=params.length;i<len;++i){if(params[i].value.length){if(params[i].name==='advanced'){console.log(typeof(params[i].value));continue;}
new_params.push(params[i].name+'='+ params[i].value);}}
window.location.href=$form.attr('action')+'?'+ new_params.join('&');};var populateSuggestion=function(values,$element){for(var i in values){$('[data-html="'+ i+'"]',$element).html(values[i]);$('[data-src="'+ i+'"]',$element).attr('src',values[i]);$('[data-href="'+ i+'"]',$element).attr('href',values[i]);}};var $focus=null;var onFocus=function(e,ui){var label=ui.item.text||ui.item.title;if($focus){$focus.removeClass('selected');}
$focus=$('#'+ ui.item.id);$focus.addClass('selected');return false;};var onSelect=function(e,ui){if(ui.item.url){window.location=ui.item.url;return false;}
var label=ui.item.text||ui.item.title;if(label){field.val(label);}
form.submit();return false;};var getBeforeAfterDates=function(object){if(typeof undefined===typeof object.prefix||null===object.prefix){return null;}
var prefix=object.prefix;var after=$('#'+ prefix+'_after');var before=$('#'+ prefix+'_before');if(!after.exists()||!before.exists()){return null;}
return[after,before];};var watchMobileDates=function(object){var dates=getBeforeAfterDates(object);if(null===dates){return;}
ngutils.forms.registerDateInput(dates[0].attr('id'));ngutils.forms.registerDateInput(dates[1].attr('id'));};var watchDates=function(object){if(PHP.get('ismobile')){watchMobileDates(object);return;}
var dates=getBeforeAfterDates(object);if(null===dates){return;}
var after=dates[0];var before=dates[1];var params={'dateFormat':'yy-mm-dd','minDate':PHP.get(object.prefix+'_min_date'),'maxDate':PHP.get(object.prefix+'_max_date'),onSelect:function(str,obj){var parts=obj.id.split('_');var which=parts[parts.length- 1];var d;var s=new Date(str);if(which==='before'&&after.val().length){d=new Date(after.val());if(typeof(d)===typeof('')&&d.indexOf('Invalid')===0){d=new Date();}
if(d>=s){d=s;d.setDate(d.getDate()- 1);if(d<new Date(obj.settings.minDate)){after.val('');}else{after.val($.datepicker.formatDate('yy-mm-dd',d));}}}else if(which==='after'&&before.val().length){d=new Date(before.val());if(typeof(d)===typeof('')&&d.indexOf('Invalid')===0){d=new Date();}
if(s>=d){d=s;d.setDate(d.getDate()+ 1);if(d>new Date(obj.settings.maxDate)){before.val('');}else{before.val($.datepicker.formatDate('yy-mm-dd',d));}}}}};after.datepicker(params);before.datepicker(params);};var watchField=function(object){var field=object.field;var form=object.form;var suggestion_endpoint=object.suggestion_endpoint;var template_id=object.template_id;var template=object.getTemplate();var render=function($ul,item){if(typeof(item.template)===typeof(undefined)||typeof(template[item.template])===typeof(undefined)){console.log('missing template for item',item);return;}
var $li=template[item.template].clone();if(typeof(item.break)!==typeof(undefined)&&item.break){$li.addClass('ui-autocomplete-break');}
$li.attr('id',item.id);populateSuggestion(item,$li);return $li.appendTo($ul);};var lookup=function(_request,_render){var search_params=form.serializeArray();$.post(suggestion_endpoint,search_params,function(response){var i;var x=0;var items=[];for(i in response.terms){x++;items.push({template:'terms',text:response.terms[i],id:template_id+"-"+x});}
for(i in response.suggestions){if(i===0){response.suggestions[i].break=true;}
x++;response.suggestions[i].id=template_id+"-"+ x;response.suggestions[i].template='content-'+ response.suggestions[i].content_type;items.push(response.suggestions[i]);}
for(i in response.more_links){if(i===0){response.more_links[i].break=true;}
x++;response.more_links[i].id=template_id+"-"+ x;response.more_links[i].template='links';items.push(response.more_links[i]);}
_render(items);});return false;};object.field.autocomplete({delay:50,source:lookup,focus:onFocus,select:onSelect}).data('ui-autocomplete')._renderItem=render;};var watchForm=function(object){var $form=object.form;var $advanced=$form.find('input[name="advanced"]');var $advanced_toggle=$form.find('a[data-toggle-advanced]');var $advanced_options=$form.find('div[data-advanced-options]');var is_advanced=PHP.get('is_advanced_search',false);if($advanced.exists()&&$advanced_options.exists()&&$advanced_toggle.exists()){$advanced_toggle.click(function(){is_advanced=!is_advanced;if(is_advanced){$advanced_options.show();$advanced.val(1);}else{$advanced_options.hide();$advanced.val(0);}
return false;});}
$form.submit(function(){conductSearch($form);return false;});};var watchSearchBar=function(object){var $searchbar=object.form;var $nav=$searchbar.find('nav');if(!$searchbar.exists()||!$nav.exists()){return;}
var current=PHP.get(object.prefix+'_current_nav');if(current){$('a:contains('+ current+')',$nav).addClass('current');}
var getSearchParams=function(url){var name,value=null;url=url||window.location.href;parts=url.split('?');if(parts.length===1){return[];}
parts=parts[1].split('&');params={};for(i=0,len=parts.length;i<len;++i){bits=parts[i].split('=');name=bits[0];if(typeof undefined!==typeof bits[1]){value=decodeURIComponent(bits[1].replace(/\+/g,' '));}else{value=null;}
params[name]=value;}
return params;};$nav.find('a').on('click',function(){var url=window.location.href;var params=getSearchParams(url);var new_params=['terms='+ $searchbar.find('input[name="terms"]').val()];for(var n in params){if(n!=='terms'){new_params.push(n+'='+ params[n]);}}
var new_url=this.href.split('?')[0]+'?'+ new_params.join('&');window.location.href=new_url;return false;});};var watchSuitabilities=function(object){var inputs=object.form.find('[id^="suitabilities_opts"] input');if(!inputs.length){return false;}
inputs.filter(':disabled').each(function(){$('label[for="'+ $(this).attr('id')+'"]').click(function(){if(typeof(PassportHandler)!==typeof(undefined)){PassportHandler.open();}else{alert("You must be logged in to search for adult content.");}
return false;});});inputs.click(function(){var checked=this.checked;var that=this;$.post('/suitabilities',inputs.serializeArray()).done(function(){if(!PHP.get('ismobile')){conductSearch(object.form);}}).fail(function(){that.checked=!checked;});});};var helper=function(){this.form=null;this.field=null;this.suggestion_endpoint=null;this.template=null;this.template_id=null;this.autocomplete=true;this.DEFAULT_TEMPLATE='search_suggestion_template';};helper.prototype={getField:function(){return this.field;},getTemplate:function(){if(null===this.template_id){this.template_id=this.DEFAULT_TEMPLATE;}
if(null===this.template||typeof(this.template[this.template_id])===typeof undefined){this.template[this.template_id]={};var $template=$($.trim($("#"+ this.template_id).html()));var that=this;$('li[class^="ui-autocomplete-"]',$template).each(function(){var key=$(this).attr('class').replace('ui-autocomplete-','');that.template[that.template_id][key]=$(this);});return;}
return this.template[this.template_id];},initialize:function(_field,_suggestion_endpoint,_template_id,_autocomplete){var parts;this.template=this.template||{};if($.type(_field)==='string'){parts=_field.split('_');field=$('#'+ _field);}else{field=_field;parts=field.attr('id').split('_');}
var form=field.parents('form');if(!form){throw"Can't find form for field.";}
this.field=field;this.form=form;this.prefix=parts[0];this.autocomplete=(typeof _autocomplete==='undefined'?true:_autocomplete);if(this.autocomplete){if((typeof(_suggestion_endpoint)!==typeof undefined)&&(null!==_suggestion_endpoint)){this.suggestion_endpoint=_suggestion_endpoint;}else{this.suggestion_endpoint=form.attr('action');}
if(typeof(_template_id)!==typeof undefined&&null!==_template_id){this.template_id=_template_id;}
this.getTemplate();watchField(this);}
watchDates(this);watchForm(this);watchSearchBar(this);watchSuitabilities(this);return this;}}
helper.init=function(_field,_suggestion_endpoint,_template_id,_autocomplete){var h=new helper();return h.initialize(_field,_suggestion_endpoint,_template_id,_autocomplete);};return{init:helper.init}})(jQuery);var addSwappableElement,addSwappableHTML,drawSwappableElement,fillSwappableElements,clearSwappableElements;(function(){var
user_is_a_leech=true,swappable_names={},swappable_code=[];var get_substitution=function(ending,width,height){return'<iframe src="http://www.newgrounds.com/promo/store_promo'+ ending+'.html" height="'+ height+'" width="'+ width+'" scrolling="no" frameborder="0"></iframe>';};var substitute_codes={'728x90':get_substitution('_wide',728,90),'630x90':get_substitution('630x90',630,90),'125x600':get_substitution('125x600',600,125),'200x200':get_substitution('200x200',200,200),'300x250':get_substitution('300x250',250,300)};substitute_codes.wide=substitute_codes['728x90'];substitute_codes.sky=substitute_codes['125x600'];substitute_codes.square=substitute_codes['200x200'];substitute_codes.box=substitute_codes['300x250'];addSwappableElement=function(base_code,code_type,element_id){element_id=addSwappableHTML(base_code,code_type,element_id);drawSwappableElement(element_id);};addSwappableHTML=function(base_code,code_type,element_id){if(!element_id){element_id='swappable_html';}
if(swappable_names[element_id]!==undefined){swappable_names[element_id]++;element_id=element_id+'_duplicate_'+ swappable_names[element_id];}else{swappable_names[element_id]=0;}
if(code_type===undefined){code_type=null;}
swappable_code.push({element_id:element_id,base_code:base_code,code_type:code_type});return element_id;};drawSwappableElement=function(element_id){document.write('<div id="'+ element_id+'"></div>');};fillSwappableElements=function(){var i,element,code_type;for(i=0;i<swappable_code.length;i++){element=$('#'+ swappable_code[i].element_id);if(element.length){code_type=swappable_code[i].code_type;if(user_is_a_leech&&code_type!==null){if(substitute_codes[code_type]===undefined){element.html(code_type);}else{element.html(substitute_codes[code_type]);}}else{element.html(swappable_code[i].base_code);}}}};clearSwappableElements=function(){for(var i=0;i<swappable_code.length;i++){$('#'+ swappable_code[i].element_id).html('');}};(function(){var delayed_load=PHP.get('delayed_load'),id;if(delayed_load){for(id in delayed_load){if(delayed_load.hasOwnProperty(id)){$('#'+ id).html(delayed_load[id]);}}}})();})();